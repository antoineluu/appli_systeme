Namespace(cstrategy='Entropy', datacfg='./data.yaml', device='cuda:1', mkpetype='RealPE', modelcfg='./ecelms.yaml', seed=2020, size_batch=10, snapshot_name='2021')
{'SAR_AF_DATA_PATH': '/mnt/e/dlsari/Autofocus/data/', 'filenames': ['ALPSRP020160970_L3600_T10000_25x8192x8192_Defocused_Vr(7128-7178)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP054200670_L1000_T16000_25x8192x8192_Defocused_Vr(7160-7210)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP103336310_L1000_T10000_25x8192x8192_Defocused_Vr(7186-7236)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP110940620_L1000_T18000_25x8192x8192_Defocused_Vr(7163-7213)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP115120970_L2100_T10000_25x8192x8192_Defocused_Vr(7147-7197)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP268560540_L2000_T3000_25x8192x8192_Defocused_Vr(7165-7215)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP269950430_L1000_T18000_25x8192x8192_Defocused_Vr(7170-7220)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP273680670_L2000_T15000_25x8192x8192_Defocused_Vr(7160-7210)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', 'ALPSRP278552780_L1000_T15000_25x8192x8192_Defocused_Vr(7153-7203)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5'], 'trainid': [1, 2, 3, 4, 7], 'validid': [5, 6], 'testid': [0, 8]}
{'model': 'BaggingECELMs', 'Qas': [2, 3, 4, 5, 6, 7], 'Qrs': None, 'Convs': [[[32, 63, 1, 1, 1, 0, 0, 1, 1, 1]], [[32, 47, 1, 1, 1, 0, 0, 1, 1, 1]], [[32, 31, 1, 1, 1, 0, 0, 1, 1, 1]], [[32, 15, 1, 1, 1, 0, 0, 1, 1, 1]]]}
--->Train files sampling mode: sequentially
['/mnt/e/dlsari/Autofocus/data/ALPSRP054200670_L1000_T16000_25x8192x8192_Defocused_Vr(7160-7210)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', '/mnt/e/dlsari/Autofocus/data/ALPSRP103336310_L1000_T10000_25x8192x8192_Defocused_Vr(7186-7236)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', '/mnt/e/dlsari/Autofocus/data/ALPSRP110940620_L1000_T18000_25x8192x8192_Defocused_Vr(7163-7213)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', '/mnt/e/dlsari/Autofocus/data/ALPSRP115120970_L2100_T10000_25x8192x8192_Defocused_Vr(7147-7197)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', '/mnt/e/dlsari/Autofocus/data/ALPSRP273680670_L2000_T15000_25x8192x8192_Defocused_Vr(7160-7210)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5']
--->Valid files sampling mode: sequentially
['/mnt/e/dlsari/Autofocus/data/ALPSRP268560540_L2000_T3000_25x8192x8192_Defocused_Vr(7165-7215)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', '/mnt/e/dlsari/Autofocus/data/ALPSRP269950430_L1000_T18000_25x8192x8192_Defocused_Vr(7170-7220)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5']
--->Test files sampling mode: sequentially
['/mnt/e/dlsari/Autofocus/data/ALPSRP020160970_L3600_T10000_25x8192x8192_Defocused_Vr(7128-7178)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5', '/mnt/e/dlsari/Autofocus/data/ALPSRP278552780_L1000_T15000_25x8192x8192_Defocused_Vr(7153-7203)_FocusedEach_8000x256x256_AutoFocusPolyPhiMinEntropy_Epoch400.h5']
tensor(-0.5000) tensor(0.4961)
--->Train: torch.Size([20000, 256, 256, 2]) torch.Size([20000, 6]) torch.Size([20000, 6])
--->Valid: torch.Size([8000, 256, 256, 2]) torch.Size([8000, 6]) torch.Size([8000, 6])
--->Test: torch.Size([8000, 256, 256, 2]) torch.Size([8000, 6]) torch.Size([8000, 6])
Orignal Entropy(Train, Valid, Test): 9.987627029418945 10.29109001159668 10.047439575195312
Orignal Contrast(Train, Valid, Test): -3.3819918632507324 -1.986007571220398 -3.4077813625335693
/usr/local/lib/python3.6/dist-packages/torch/cuda/__init__.py:104: UserWarning: 
GeForce RTX 3090 with CUDA capability sm_86 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_37 sm_50 sm_60 sm_70.
If you want to use the GeForce RTX 3090 GPU with PyTorch, please check the instructions at https://pytorch.org/get-started/locally/

  warnings.warn(incompatible_device_warn.format(device_name, capability, " ".join(arch_list), device_name))
cuda:1
GeForce GTX 1080 Ti
Torch Version:  1.8.1+cu102
Torch CUDA Version:  10.2
CUDNN Version:  7605
CUDA TF32:  False
CUDNN TF32:  False
CUDNN Benchmark:  True
CUDNN Deterministic:  True
BaggingECELMs(
  (celms): ModuleList(
    (0): CELM(
      (features): Sequential(
        (conv1): Conv2d(2, 32, kernel_size=[63, 1], stride=[1, 1], padding=[0, 0], dilation=[1, 1])
        (in1): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (relu1): LeakyReLU(negative_slope=0.01)
        (gapool): AdaptiveAvgPool2d(output_size=(None, 1))
      )
    )
    (1): CELM(
      (features): Sequential(
        (conv1): Conv2d(2, 32, kernel_size=[47, 1], stride=[1, 1], padding=[0, 0], dilation=[1, 1])
        (in1): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (relu1): LeakyReLU(negative_slope=0.01)
        (gapool): AdaptiveAvgPool2d(output_size=(None, 1))
      )
    )
    (2): CELM(
      (features): Sequential(
        (conv1): Conv2d(2, 32, kernel_size=[31, 1], stride=[1, 1], padding=[0, 0], dilation=[1, 1])
        (in1): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (relu1): LeakyReLU(negative_slope=0.01)
        (gapool): AdaptiveAvgPool2d(output_size=(None, 1))
      )
    )
    (3): CELM(
      (features): Sequential(
        (conv1): Conv2d(2, 32, kernel_size=[15, 1], stride=[1, 1], padding=[0, 0], dilation=[1, 1])
        (in1): InstanceNorm2d(32, eps=1e-05, momentum=0.1, affine=False, track_running_stats=False)
        (relu1): LeakyReLU(negative_slope=0.01)
        (gapool): AdaptiveAvgPool2d(output_size=(None, 1))
      )
    )
  )
  (combine_metric): Entropy()
  (loss_mse_fn): MSELoss()
)
--->Train focuser: 0, C:     0.010000, loss: 15182.9971, entropy: 9.9772, l1norm: 9.8373, contrast: -3.4361, time: 11.015794038772583s
--->Valid focuser: 0, C:     0.010000, loss: 24940.1097, entropy: 10.2908, l1norm: 9.5957, contrast: -1.9908, time: 5.096900701522827s
--->Train focuser: 0, C:     0.100000, loss: 9730.2109, entropy: 9.9412, l1norm: 9.8302, contrast: -3.6599, time: 27.325840711593628s
--->Valid focuser: 0, C:     0.100000, loss: 25709.0576, entropy: 10.2855, l1norm: 9.5946, contrast: -2.0191, time: 5.1374218463897705s
--->Train focuser: 0, C:     1.000000, loss: 2426.9045, entropy: 9.8686, l1norm: 9.8160, contrast: -4.1867, time: 43.51183032989502s
--->Valid focuser: 0, C:     1.000000, loss: 29882.4327, entropy: 10.2835, l1norm: 9.5943, contrast: -2.0326, time: 5.151527404785156s
--->Train focuser: 0, C:    10.000000, loss: 218.1869, entropy: 9.8253, l1norm: 9.8075, contrast: -4.5558, time: 58.88210320472717s
--->Valid focuser: 0, C:    10.000000, loss: 38404.6025, entropy: 10.2916, l1norm: 9.5961, contrast: -1.9994, time: 5.109241724014282s
--->Train focuser: 0, C:   100.000000, loss: 6567.4819, entropy: 9.9442, l1norm: 9.8307, contrast: -3.6488, time: 74.24690771102905s
--->Valid focuser: 0, C:   100.000000, loss: 49534.3424, entropy: 10.2992, l1norm: 9.5977, contrast: -1.9688, time: 5.074878215789795s
--->Train focuser: 1, C:     0.010000, loss: 15220.1641, entropy: 9.9659, l1norm: 9.8508, contrast: -3.5316, time: 90.74989199638367s
--->Valid focuser: 1, C:     0.010000, loss: 24736.8139, entropy: 10.2894, l1norm: 9.5954, contrast: -1.9948, time: 5.214573621749878s
--->Train focuser: 1, C:     0.100000, loss: 9364.1680, entropy: 9.9111, l1norm: 9.8401, contrast: -3.9120, time: 106.11148619651794s
--->Valid focuser: 1, C:     0.100000, loss: 25260.0901, entropy: 10.2792, l1norm: 9.5933, contrast: -2.0489, time: 5.178676128387451s
--->Train focuser: 1, C:     1.000000, loss: 2192.3911, entropy: 9.8400, l1norm: 9.8262, contrast: -4.4425, time: 121.08034348487854s
--->Valid focuser: 1, C:     1.000000, loss: 29496.1993, entropy: 10.2743, l1norm: 9.5923, contrast: -2.0766, time: 5.218718528747559s
--->Train focuser: 1, C:    10.000000, loss: 203.1203, entropy: 9.8053, l1norm: 9.8195, contrast: -4.7390, time: 135.75523376464844s
--->Valid focuser: 1, C:    10.000000, loss: 37730.6299, entropy: 10.2807, l1norm: 9.5938, contrast: -2.0474, time: 5.154122829437256s
--->Train focuser: 1, C:   100.000000, loss: 5275.6729, entropy: 9.8334, l1norm: 9.8250, contrast: -4.5052, time: 151.3967912197113s
--->Valid focuser: 1, C:   100.000000, loss: 46348.4546, entropy: 10.2833, l1norm: 9.5943, contrast: -2.0367, time: 5.284227609634399s
--->Train focuser: 2, C:     0.010000, loss: 14281.2842, entropy: 9.9649, l1norm: 9.8460, contrast: -3.5733, time: 166.8156704902649s
--->Valid focuser: 2, C:     0.010000, loss: 24673.9280, entropy: 10.2869, l1norm: 9.5948, contrast: -2.0061, time: 5.3169732093811035s
--->Train focuser: 2, C:     0.100000, loss: 8461.4033, entropy: 9.9067, l1norm: 9.8344, contrast: -3.9449, time: 181.76637077331543s
--->Valid focuser: 2, C:     0.100000, loss: 25234.1374, entropy: 10.2736, l1norm: 9.5920, contrast: -2.0734, time: 5.351912498474121s
--->Train focuser: 2, C:     1.000000, loss: 1943.5671, entropy: 9.8415, l1norm: 9.8217, contrast: -4.4359, time: 195.85346508026123s
--->Valid focuser: 2, C:     1.000000, loss: 29478.6043, entropy: 10.2703, l1norm: 9.5914, contrast: -2.0918, time: 5.264580011367798s
--->Train focuser: 2, C:    10.000000, loss: 137.2808, entropy: 9.8058, l1norm: 9.8148, contrast: -4.7623, time: 210.43848395347595s
--->Valid focuser: 2, C:    10.000000, loss: 36936.7025, entropy: 10.2770, l1norm: 9.5929, contrast: -2.0628, time: 5.269765138626099s
--->Train focuser: 2, C:   100.000000, loss: 7398.5840, entropy: 9.8141, l1norm: 9.8165, contrast: -4.6959, time: 224.88950419425964s
--->Valid focuser: 2, C:   100.000000, loss: 47297.4764, entropy: 10.2788, l1norm: 9.5933, contrast: -2.0567, time: 5.405895471572876s
--->Train focuser: 3, C:     0.010000, loss: 14106.9873, entropy: 9.9576, l1norm: 9.8430, contrast: -3.6126, time: 240.6839783191681s
--->Valid focuser: 3, C:     0.010000, loss: 24431.5252, entropy: 10.2848, l1norm: 9.5944, contrast: -2.0163, time: 5.436328887939453s
--->Train focuser: 3, C:     0.100000, loss: 8248.1406, entropy: 9.8975, l1norm: 9.8308, contrast: -4.0259, time: 257.11860704421997s
--->Valid focuser: 3, C:     0.100000, loss: 24875.2848, entropy: 10.2686, l1norm: 9.5910, contrast: -2.1024, time: 5.450915336608887s
--->Train focuser: 3, C:     1.000000, loss: 2035.4949, entropy: 9.8409, l1norm: 9.8198, contrast: -4.4554, time: 271.8559720516205s
--->Valid focuser: 3, C:     1.000000, loss: 29518.0402, entropy: 10.2682, l1norm: 9.5909, contrast: -2.1071, time: 5.519978284835815s
--->Train focuser: 3, C:    10.000000, loss: 158.8227, entropy: 9.8073, l1norm: 9.8133, contrast: -4.7493, time: 287.7657859325409s
--->Valid focuser: 3, C:    10.000000, loss: 37543.1510, entropy: 10.2762, l1norm: 9.5926, contrast: -2.0692, time: 5.475317716598511s
--->Train focuser: 3, C:   100.000000, loss: 1471.0260, entropy: 9.8988, l1norm: 9.8312, contrast: -4.0112, time: 303.39086985588074s
--->Valid focuser: 3, C:   100.000000, loss: 41532.9933, entropy: 10.2821, l1norm: 9.5940, contrast: -2.0474, time: 5.501010894775391s
---Best C [1.0, 1.0, 1.0, 1.0]
--->Train ensemble: 4, loss: 15556.4611, entropy: 9.8482, l1norm: 9.7691, contrast: -4.3444, time: 45.85082459449768s
--->Valid ensemble: 4, loss: 27774.6749, entropy: 10.2349, l1norm: 9.5841, contrast: -2.2916, time: 18.247244119644165s
--->Test ensemble: 4, loss: 22781.9341, entropy: 9.9319, l1norm: 9.8211, contrast: -4.3190, time: 18.252463817596436s
[Finished in 689.4s]
